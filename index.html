<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimpleSNS - SNSÂ≠¶Áøí„Ç¢„Éó„É™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            position: relative;
        }

        .version {
            position: absolute;
            top: 0.5rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.5rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: normal;
        }

        .auth-section {
            padding: 2rem;
            text-align: center;
        }

        .auth-form {
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 1rem;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
            font-weight: 500;
        }

        input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            margin-bottom: 1rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.4);
        }

        .main-app {
            display: none;
        }

        .post-form {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            background: #fafafa;
        }

        .post-textarea {
            width: 100%;
            min-height: 100px;
            padding: 1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            resize: vertical;
            font-family: inherit;
        }

        .post-textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .post-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }

        .char-count {
            color: #666;
            font-size: 0.9rem;
        }

        .char-count.warning {
            color: #ff6b6b;
        }

        .timeline {
            max-height: calc(100vh - 300px);
            overflow-y: auto;
        }

        .post {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s;
        }

        .post:hover {
            background-color: #f8f9fa;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 0.75rem;
            font-size: 1.2rem;
        }

        .post-meta {
            flex: 1;
        }

        .username {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.25rem;
        }

        .timestamp {
            color: #666;
            font-size: 0.85rem;
        }

        .post-content {
            margin-bottom: 1rem;
            color: #333;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .post-actions-bar {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .like-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: 20px;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .like-btn:hover {
            background-color: #fee;
            color: #e63946;
        }

        .like-btn.liked {
            color: #e63946;
            background-color: #fee;
        }

        .user-info {
            padding: 1rem;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .current-user {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .logout-btn:hover {
            background: #c82333;
        }

        .navigation {
            padding: 1rem;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .nav-btn {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .nav-btn:hover, .nav-btn.active {
            background: #667eea;
            color: white;
        }

        .share-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: 20px;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .share-btn:hover {
            background-color: #e3f2fd;
            color: #1976d2;
        }

        .user-badge {
            background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            color: #8b4513;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-weight: bold;
            margin-left: 0.5rem;
        }

        .user-stats {
            display: flex;
            gap: 1rem;
            font-size: 0.8rem;
            color: #666;
            margin-top: 0.3rem;
        }

        .profile-section {
            padding: 2rem;
            text-align: center;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin: 0 auto 1rem;
            font-size: 3rem;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .ranking-section {
            padding: 2rem;
        }

        .ranking-list {
            list-style: none;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: white;
            margin-bottom: 0.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .rank-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 1rem;
        }

        .rank-number.gold {
            background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            color: #8b4513;
        }

        .rank-number.silver {
            background: linear-gradient(135deg, #c0c0c0 0%, #a8a8a8 100%);
            color: #444;
        }

        .rank-number.bronze {
            background: linear-gradient(135deg, #cd7f32 0%, #b87333 100%);
            color: white;
        }

        .users-section {
            padding: 2rem;
        }

        .user-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .user-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }

        .empty-timeline {
            text-align: center;
            padding: 3rem;
            color: #666;
        }

        .switch-form {
            text-align: center;
            margin-top: 1rem;
            color: #666;
        }

        .switch-form a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .switch-form a:hover {
            text-decoration: underline;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 1rem 0;
            font-size: 0.9rem;
            color: #666;
        }

        .quick-login {
            background: #28a745;
            margin-bottom: 0.5rem;
        }

        .quick-login:hover {
            background: #218838;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        }

        @media (max-width: 768px) {
            .container {
                box-shadow: none;
            }

            .auth-section {
                padding: 1rem;
            }

            .post-form {
                padding: 1rem;
            }

            .post {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="version" id="app-version">v0.01</div>
            <h1>üåü SimpleSNS</h1>
            <p>„Ç∑„É≥„Éó„É´„Å™SNSÂ≠¶Áøí„Ç¢„Éó„É™</p>
        </div>

        <!-- „É≠„Ç∞„Ç§„É≥„ÉªÁôªÈå≤ÁîªÈù¢ -->
        <div id="auth-section" class="auth-section">
            <div id="login-form" class="auth-form">
                <h2>„É≠„Ç∞„Ç§„É≥</h2>
                <div class="form-group">
                    <label for="login-username">„É¶„Éº„Ç∂„ÉºÂêç</label>
                    <input type="text" id="login-username" placeholder="„É¶„Éº„Ç∂„ÉºÂêç„ÇíÂÖ•Âäõ">
                </div>
                <div class="form-group">
                    <label for="login-password">„Éë„Çπ„ÉØ„Éº„Éâ</label>
                    <input type="password" id="login-password" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ">
                </div>
                <div class="remember-me">
                    <input type="checkbox" id="remember-me" checked>
                    <label for="remember-me">Ê¨°Âõû„Åã„ÇâËá™Âãï„É≠„Ç∞„Ç§„É≥</label>
                </div>
                <button id="quick-login-btn" class="btn quick-login" onclick="quickLogin()" style="display: none;">üìù ÂâçÂõû„ÅÆ„É¶„Éº„Ç∂„Éº„Åß„É≠„Ç∞„Ç§„É≥</button>
                <button class="btn" onclick="login()">„É≠„Ç∞„Ç§„É≥</button>
                <div class="switch-form">
                    „Ç¢„Ç´„Ç¶„É≥„Éà„Çí„ÅäÊåÅ„Å°„Åß„Å™„ÅÑÊñπ„ÅØ <a href="#" onclick="showRegister()">Êñ∞Ë¶èÁôªÈå≤</a>
                </div>
            </div>

            <div id="register-form" class="auth-form" style="display: none;">
                <h2>Êñ∞Ë¶èÁôªÈå≤</h2>
                <div class="form-group">
                    <label for="register-username">„É¶„Éº„Ç∂„ÉºÂêç</label>
                    <input type="text" id="register-username" placeholder="„É¶„Éº„Ç∂„ÉºÂêç„ÇíÂÖ•ÂäõÔºà3ÊñáÂ≠ó‰ª•‰∏äÔºâ">
                </div>
                <div class="form-group">
                    <label for="register-password">„Éë„Çπ„ÉØ„Éº„Éâ</label>
                    <input type="password" id="register-password" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•ÂäõÔºà6ÊñáÂ≠ó‰ª•‰∏äÔºâ">
                </div>
                <div class="form-group">
                    <label for="register-confirm">„Éë„Çπ„ÉØ„Éº„ÉâÁ¢∫Ë™ç</label>
                    <input type="password" id="register-confirm" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÜçÂÖ•Âäõ">
                </div>
                <button class="btn" onclick="register()">Êñ∞Ë¶èÁôªÈå≤</button>
                <div class="switch-form">
                    „Åô„Åß„Å´„Ç¢„Ç´„Ç¶„É≥„Éà„Çí„ÅäÊåÅ„Å°„ÅÆÊñπ„ÅØ <a href="#" onclick="showLogin()">„É≠„Ç∞„Ç§„É≥</a>
                </div>
            </div>
        </div>

        <!-- „É°„Ç§„É≥„Ç¢„Éó„É™ÁîªÈù¢ -->
        <div id="main-app" class="main-app">
            <div class="user-info">
                <div class="current-user">
                    <div class="user-avatar" id="current-user-avatar"></div>
                    <div>
                        <span id="current-username"></span>
                        <span id="current-user-badge" class="user-badge"></span>
                        <div id="current-user-stats" class="user-stats"></div>
                    </div>
                </div>
                <button class="logout-btn" onclick="logout()">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
            </div>

            <div class="navigation">
                <button class="nav-btn active" onclick="showSection('timeline')">üè† „Éõ„Éº„É†</button>
                <button class="nav-btn" onclick="showSection('profile')">üë§ „Éó„É≠„Éï„Ç£„Éº„É´</button>
                <button class="nav-btn" onclick="showSection('ranking')">üèÜ „É©„É≥„Ç≠„É≥„Ç∞</button>
                <button class="nav-btn" onclick="showSection('users')">üë• „É¶„Éº„Ç∂„Éº</button>
            </div>


            <div id="timeline-section">
                <div class="post-form">
                    <textarea id="post-content" class="post-textarea" placeholder="‰ªä‰Ωï„Åó„Å¶„ÇãÔºü"></textarea>
                    <div class="post-actions">
                        <div class="char-count" id="char-count">0/280</div>
                        <button class="btn" onclick="createPost()" style="width: auto; padding: 0.5rem 1.5rem;">ÊäïÁ®ø</button>
                    </div>
                </div>

                <div id="timeline" class="timeline">
                    <div class="empty-timeline">
                        <h3>üìù „Çø„Ç§„É†„É©„Ç§„É≥„ÅåÁ©∫„Åß„Åô</h3>
                        <p>ÊúÄÂàù„ÅÆÊäïÁ®ø„Çí„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜÔºÅ</p>
                    </div>
                </div>
            </div>

            <div id="profile-section" class="profile-section" style="display: none;">
                <div class="profile-avatar" id="profile-avatar"></div>
                <h2 id="profile-username"></h2>
                <span id="profile-badge" class="user-badge"></span>
                <div class="profile-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="profile-posts">0</div>
                        <div class="stat-label">ÊäïÁ®øÊï∞</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="profile-likes">0</div>
                        <div class="stat-label">„ÇÇ„Çâ„Å£„Åü„ÅÑ„ÅÑ„Å≠</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="profile-days">0</div>
                        <div class="stat-label">Âà©Áî®Êó•Êï∞</div>
                    </div>
                </div>
            </div>

            <div id="ranking-section" class="ranking-section" style="display: none;">
                <h2>üèÜ „É©„É≥„Ç≠„É≥„Ç∞</h2>
                <h3>ÊäïÁ®øÊï∞„É©„É≥„Ç≠„É≥„Ç∞</h3>
                <ul id="post-ranking" class="ranking-list"></ul>
                <h3>„ÅÑ„ÅÑ„Å≠Êï∞„É©„É≥„Ç≠„É≥„Ç∞</h3>
                <ul id="like-ranking" class="ranking-list"></ul>
            </div>

            <div id="users-section" class="users-section" style="display: none;">
                <h2>üë• „É¶„Éº„Ç∂„Éº‰∏ÄË¶ß</h2>
                <div id="user-grid" class="user-grid"></div>
            </div>
        </div>
    </div>

    <script>
        // „Éá„Éº„ÇøÁÆ°ÁêÜ
        let currentUser = null;
        let posts = [];
        let users = {};
        let currentSection = 'timeline';
        let appVersion = '0.01';

        // ÂàùÊúüÂåñ
        function init() {
            loadData();
            initializeSampleData();
            setupEventListeners();
            checkAuthStatus();
        }

        // „Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø
        function loadData() {
            const savedUsers = localStorage.getItem('sns-users');
            const savedPosts = localStorage.getItem('sns-posts');
            const savedCurrentUser = localStorage.getItem('sns-current-user');

            if (savedUsers) {
                users = JSON.parse(savedUsers);
            }
            if (savedPosts) {
                posts = JSON.parse(savedPosts);
            }
            if (savedCurrentUser) {
                currentUser = JSON.parse(savedCurrentUser);
            }
        }

        // „Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÅÆÂàùÊúüÂåñ
        function initializeSampleData() {
            // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Çí„ÇØ„É™„Ç¢„Åó„Å¶„Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÇíÂº∑Âà∂ÁöÑ„Å´‰ΩúÊàê
            console.log('Initializing sample data...');

            // Êó¢„Å´„Éá„Éº„Çø„Åå„ÅÇ„ÇãÂ†¥Âêà„Åß„ÇÇÂÜçÂàùÊúüÂåñÔºà„ÉÜ„Çπ„ÉàÁî®Ôºâ
            // if (Object.keys(users).length > 0) return;

            // „Çµ„É≥„Éó„É´„É¶„Éº„Ç∂„Éº„Çí‰ΩúÊàê
            const sampleUsers = [
                { username: 'ai_lover', password: 'password123' },
                { username: 'tech_guru', password: 'password123' },
                { username: 'daily_life', password: 'password123' }
            ];

            const baseTime = Date.now() - (7 * 24 * 60 * 60 * 1000); // 7Êó•Ââç

            sampleUsers.forEach((user, index) => {
                users[user.username] = {
                    username: user.username,
                    password: user.password,
                    createdAt: new Date(baseTime + index * 1000).toISOString()
                };
            });

            // „Çµ„É≥„Éó„É´ÊäïÁ®ø„Çí‰ΩúÊàê
            const samplePosts = [
                { username: 'ai_lover', content: 'AI„ÅÆÈÄ≤Ê≠©„Åå„Åô„Åî„ÅÑ„Åß„Åô„Å≠ÔºÅChatGPT„Çí‰Ωø„Å£„Å¶‰ªï‰∫ã„ÅÆÂäπÁéá„Åå‰∏ä„Åå„Çä„Åæ„Åó„Åü ü§ñ', time: -6 },
                { username: 'tech_guru', content: '„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Â≠¶Áøí‰∏≠„Åß„Åô„ÄÇJavaScript„ÅÆPromise„Å´„Å§„ÅÑ„Å¶ÁêÜËß£„ÅåÊ∑±„Åæ„Çä„Åæ„Åó„Åü üíª', time: -5 },
                { username: 'daily_life', content: '‰ªäÊó•„ÅØÁæéÂë≥„Åó„ÅÑ„É©„Éº„É°„É≥„ÇíÈ£ü„Åπ„Åæ„Åó„ÅüÔºÅÂπ∏„Åõ„Äú üçú', time: -4 },
                { username: 'ai_lover', content: 'Ê©üÊ¢∞Â≠¶Áøí„ÅÆÂãâÂº∑„ÇíÂßã„ÇÅ„Åæ„Åó„Åü„ÄÇÊï∞Â≠¶„ÅåÊÄù„Å£„Åü„Çà„ÇäÂ§ßÂ§â... üìö', time: -3 },
                { username: 'tech_guru', content: '„É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥„ÇíÂÆüË£Ö‰∏≠„ÄÇCSS„Ç∞„É™„ÉÉ„Éâ„Åå‰æøÂà©„Åß„Åô„Å≠', time: -2 },
                { username: 'daily_life', content: '„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ‰ªäÊó•„ÇÇ‰∏ÄÊó•È†ëÂºµ„Çä„Åæ„Åó„Çá„ÅÜ ‚òÄÔ∏è', time: -1 },
                { username: 'ai_lover', content: 'SNS„Ç¢„Éó„É™„Çí‰Ωú„Å£„Å¶„Åø„Åü„ÅÑ„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ„Å©„ÅÆÊäÄË°ì„Çπ„Çø„ÉÉ„ÇØ„Åå„Åä„Åô„Åô„ÇÅ„Åß„Åó„Çá„ÅÜ„ÅãÔºü', time: 0 }
            ];

            samplePosts.forEach((postData, index) => {
                const post = {
                    id: baseTime + index * 1000 + Math.floor(postData.time * 60 * 60 * 1000),
                    username: postData.username,
                    content: postData.content,
                    timestamp: new Date(Date.now() + postData.time * 60 * 60 * 1000).toISOString(),
                    likes: []
                };

                // „É©„É≥„ÉÄ„É†„Å´„ÅÑ„ÅÑ„Å≠„ÇíËøΩÂä†
                const allUsers = Object.keys(users);
                const likeCount = Math.floor(Math.random() * 3);
                for (let i = 0; i < likeCount; i++) {
                    const randomUser = allUsers[Math.floor(Math.random() * allUsers.length)];
                    if (!post.likes.includes(randomUser)) {
                        post.likes.push(randomUser);
                    }
                }

                posts.unshift(post);
            });

            saveData();
        }

        // „Éá„Éº„Çø„ÅÆ‰øùÂ≠ò
        function saveData() {
            localStorage.setItem('sns-users', JSON.stringify(users));
            localStorage.setItem('sns-posts', JSON.stringify(posts));
            localStorage.setItem('sns-current-user', JSON.stringify(currentUser));
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆË®≠ÂÆö
        function setupEventListeners() {
            // „Ç®„É≥„Çø„Éº„Ç≠„Éº„Åß„É≠„Ç∞„Ç§„É≥
            document.getElementById('login-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });

            // „Ç®„É≥„Çø„Éº„Ç≠„Éº„ÅßÁôªÈå≤
            document.getElementById('register-confirm').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    register();
                }
            });

            // ÊäïÁ®øÊñáÂ≠óÊï∞„Ç´„Ç¶„É≥„Éà
            document.getElementById('post-content').addEventListener('input', function() {
                const content = this.value;
                const charCount = document.getElementById('char-count');
                charCount.textContent = `${content.length}/280`;

                if (content.length > 280) {
                    charCount.classList.add('warning');
                } else {
                    charCount.classList.remove('warning');
                }
            });

            // Ctrl+Enter„ÅßÊäïÁ®ø
            document.getElementById('post-content').addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    createPost();
                }
            });
        }

        // Ë™çË®ºÁä∂ÊÖã„ÉÅ„Çß„ÉÉ„ÇØ
        function checkAuthStatus() {
            if (currentUser) {
                showMainApp();
            } else {
                showAuthSection();
                setupQuickLogin();
            }
        }

        // „ÇØ„Ç§„ÉÉ„ÇØ„É≠„Ç∞„Ç§„É≥Ë®≠ÂÆö
        function setupQuickLogin() {
            const lastUsername = localStorage.getItem('sns-last-username');
            const rememberMe = localStorage.getItem('sns-remember-me') === 'true';

            if (lastUsername && rememberMe) {
                document.getElementById('login-username').value = lastUsername;
                document.getElementById('login-password').value = 'password123'; // „Çµ„É≥„Éó„É´Áî®

                const quickLoginBtn = document.getElementById('quick-login-btn');
                quickLoginBtn.style.display = 'block';
                quickLoginBtn.innerHTML = `üìù ${lastUsername} „Åß„É≠„Ç∞„Ç§„É≥`;
            }
        }

        // „ÇØ„Ç§„ÉÉ„ÇØ„É≠„Ç∞„Ç§„É≥
        function quickLogin() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;

            if (username && password) {
                login();
            }
        }

        // ÁôªÈå≤ÁîªÈù¢Ë°®Á§∫
        function showRegister() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('register-form').style.display = 'block';
        }

        // „É≠„Ç∞„Ç§„É≥ÁîªÈù¢Ë°®Á§∫
        function showLogin() {
            document.getElementById('register-form').style.display = 'none';
            document.getElementById('login-form').style.display = 'block';
        }

        // Ë™çË®º„Çª„ÇØ„Ç∑„Éß„É≥Ë°®Á§∫
        function showAuthSection() {
            document.getElementById('auth-section').style.display = 'block';
            document.getElementById('main-app').style.display = 'none';
        }

        // „É°„Ç§„É≥„Ç¢„Éó„É™Ë°®Á§∫
        function showMainApp() {
            document.getElementById('auth-section').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';

            // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±Ë°®Á§∫
            const avatar = document.getElementById('current-user-avatar');
            const username = document.getElementById('current-username');

            avatar.textContent = currentUser.username.charAt(0).toUpperCase();
            username.textContent = currentUser.username;

            // „É¶„Éº„Ç∂„ÉºÁµ±Ë®à„ÇíÊõ¥Êñ∞
            updateUserStats();

            // „Çø„Ç§„É†„É©„Ç§„É≥Êõ¥Êñ∞
            renderTimeline();

            // „Éá„Éï„Ç©„É´„Éà„Çª„ÇØ„Ç∑„Éß„É≥Ë°®Á§∫
            showSection('timeline');
        }

        // Êñ∞Ë¶èÁôªÈå≤
        function register() {
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;

            // „Éê„É™„Éá„Éº„Ç∑„Éß„É≥
            if (username.length < 3) {
                alert('„É¶„Éº„Ç∂„ÉºÂêç„ÅØ3ÊñáÂ≠ó‰ª•‰∏ä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }

            if (password.length < 6) {
                alert('„Éë„Çπ„ÉØ„Éº„Éâ„ÅØ6ÊñáÂ≠ó‰ª•‰∏ä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }

            if (password !== confirm) {
                alert('„Éë„Çπ„ÉØ„Éº„Éâ„Åå‰∏ÄËá¥„Åó„Åæ„Åõ„Çì');
                return;
            }

            if (users[username]) {
                alert('„Åì„ÅÆ„É¶„Éº„Ç∂„ÉºÂêç„ÅØÊó¢„Å´‰ΩøÁî®„Åï„Çå„Å¶„ÅÑ„Åæ„Åô');
                return;
            }

            // „É¶„Éº„Ç∂„Éº‰ΩúÊàê
            users[username] = {
                username: username,
                password: password,
                createdAt: new Date().toISOString()
            };

            currentUser = users[username];

            // Ëá™Âãï„É≠„Ç∞„Ç§„É≥Ë®≠ÂÆö„Çí‰øùÂ≠ò
            localStorage.setItem('sns-last-username', username);
            localStorage.setItem('sns-remember-me', 'true');

            saveData();
            incrementVersion();

            alert('ÁôªÈå≤„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ');
            showMainApp();
        }

        // „É≠„Ç∞„Ç§„É≥
        function login() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;

            if (!username || !password) {
                alert('„É¶„Éº„Ç∂„ÉºÂêç„Å®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }

            const user = users[username];
            if (!user || user.password !== password) {
                alert('„É¶„Éº„Ç∂„ÉºÂêç„Åæ„Åü„ÅØ„Éë„Çπ„ÉØ„Éº„Éâ„ÅåÈñìÈÅï„Å£„Å¶„ÅÑ„Åæ„Åô');
                return;
            }

            currentUser = user;

            // Ë®òÊÜ∂Ë®≠ÂÆö„Çí‰øùÂ≠ò
            const rememberMe = document.getElementById('remember-me').checked;
            if (rememberMe) {
                localStorage.setItem('sns-last-username', username);
                localStorage.setItem('sns-remember-me', 'true');
            } else {
                localStorage.removeItem('sns-last-username');
                localStorage.removeItem('sns-remember-me');
            }

            saveData();
            incrementVersion();
            showMainApp();
        }

        // „É≠„Ç∞„Ç¢„Ç¶„Éà
        function logout() {
            if (confirm('„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü')) {
                currentUser = null;
                localStorage.removeItem('sns-current-user');

                // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢ÔºàË®òÊÜ∂Ë®≠ÂÆö„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØÊúÄÂæå„ÅÆ„É¶„Éº„Ç∂„ÉºÂêç„ÅØÊÆã„ÅôÔºâ
                const rememberMe = localStorage.getItem('sns-remember-me') === 'true';
                if (!rememberMe) {
                    document.getElementById('login-username').value = '';
                    document.getElementById('login-password').value = '';
                }
                document.getElementById('post-content').value = '';
                document.getElementById('char-count').textContent = '0/280';

                showAuthSection();
                setupQuickLogin();
            }
        }

        // ÊäïÁ®ø‰ΩúÊàê
        function createPost() {
            const content = document.getElementById('post-content').value.trim();

            if (!content) {
                alert('ÊäïÁ®øÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }

            if (content.length > 280) {
                alert('ÊäïÁ®ø„ÅØ280ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }

            const post = {
                id: Date.now(),
                username: currentUser.username,
                content: content,
                timestamp: new Date().toISOString(),
                likes: []
            };

            posts.unshift(post);
            saveData();
            incrementVersion();

            // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢
            document.getElementById('post-content').value = '';
            document.getElementById('char-count').textContent = '0/280';

            renderTimeline();
        }

        // „Çø„Ç§„É†„É©„Ç§„É≥ÊèèÁîª
        function renderTimeline() {
            const timeline = document.getElementById('timeline');

            if (posts.length === 0) {
                timeline.innerHTML = `
                    <div class="empty-timeline">
                        <h3>üìù „Çø„Ç§„É†„É©„Ç§„É≥„ÅåÁ©∫„Åß„Åô</h3>
                        <p>ÊúÄÂàù„ÅÆÊäïÁ®ø„Çí„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜÔºÅ</p>
                    </div>
                `;
                return;
            }

            timeline.innerHTML = posts.map(post => {
                const userBadge = getUserBadge(post.username);
                return `
                <div class="post">
                    <div class="post-header">
                        <div class="user-avatar">${post.username.charAt(0).toUpperCase()}</div>
                        <div class="post-meta">
                            <div class="username">
                                ${post.username}
                                ${userBadge ? `<span class="user-badge">${userBadge}</span>` : ''}
                            </div>
                            <div class="timestamp">${formatTimestamp(post.timestamp)}</div>
                        </div>
                    </div>
                    <div class="post-content">${escapeHtml(post.content)}</div>
                    <div class="post-actions-bar">
                        <button class="like-btn ${post.likes.includes(currentUser.username) ? 'liked' : ''}"
                                onclick="toggleLike(${post.id})">
                            ‚ù§Ô∏è ${post.likes.length > 0 ? post.likes.length : ''}
                        </button>
                        <button class="share-btn" onclick="sharePost(${post.id})">
                            üì§ „Ç∑„Çß„Ç¢
                        </button>
                    </div>
                </div>
                `;
            }).join('');
        }

        // „ÅÑ„ÅÑ„Å≠Ê©üËÉΩ
        function toggleLike(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;

            const username = currentUser.username;
            const likeIndex = post.likes.indexOf(username);

            if (likeIndex === -1) {
                // „ÅÑ„ÅÑ„Å≠„ÇíËøΩÂä†
                post.likes.push(username);
            } else {
                // „ÅÑ„ÅÑ„Å≠„ÇíÂâäÈô§
                post.likes.splice(likeIndex, 1);
            }

            saveData();
            incrementVersion();
            updateUserStats();
            renderTimeline();
        }

        // „Çø„Ç§„É†„Çπ„Çø„É≥„Éó„ÅÆ„Éï„Ç©„Éº„Éû„ÉÉ„Éà
        function formatTimestamp(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;

            const seconds = Math.floor(diff / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);

            if (days > 0) {
                return `${days}Êó•Ââç`;
            } else if (hours > 0) {
                return `${hours}ÊôÇÈñìÂâç`;
            } else if (minutes > 0) {
                return `${minutes}ÂàÜÂâç`;
            } else {
                return '‰ªä';
            }
        }

        // HTML„Ç®„Çπ„Ç±„Éº„Éó
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // „Çª„ÇØ„Ç∑„Éß„É≥Ë°®Á§∫Âà∂Âæ°
        function showSection(section) {
            currentSection = section;

            // „Åô„Åπ„Å¶„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÈùûË°®Á§∫
            document.getElementById('timeline-section').style.display = 'none';
            document.getElementById('profile-section').style.display = 'none';
            document.getElementById('ranking-section').style.display = 'none';
            document.getElementById('users-section').style.display = 'none';

            // „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éú„Çø„É≥„ÅÆÁä∂ÊÖã„Çí„É™„Çª„ÉÉ„Éà
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å™„Çª„ÇØ„Ç∑„Éß„É≥„ÇíË°®Á§∫
            document.getElementById(section + '-section').style.display = 'block';

            // „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éú„Çø„É≥„ÇíË®≠ÂÆöÔºàevent.target„ÅÆ‰ª£„Çè„Çä„Å´Áõ¥Êé•ÊåáÂÆöÔºâ
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if (btn.textContent.includes(section === 'timeline' ? '„Éõ„Éº„É†' :
                    section === 'profile' ? '„Éó„É≠„Éï„Ç£„Éº„É´' :
                    section === 'ranking' ? '„É©„É≥„Ç≠„É≥„Ç∞' : '„É¶„Éº„Ç∂„Éº')) {
                    btn.classList.add('active');
                }
            });

            // „Çª„ÇØ„Ç∑„Éß„É≥„Å´Âøú„Åò„Å¶ÂÜÖÂÆπ„ÇíÊõ¥Êñ∞
            switch(section) {
                case 'timeline':
                    renderTimeline();
                    break;
                case 'profile':
                    showProfile();
                    break;
                case 'ranking':
                    showRanking();
                    break;
                case 'users':
                    showUsers();
                    break;
            }
        }

        // „Éó„É≠„Éï„Ç£„Éº„É´Ë°®Á§∫
        function showProfile() {
            const avatar = document.getElementById('profile-avatar');
            const username = document.getElementById('profile-username');
            const badge = document.getElementById('profile-badge');
            const postsCount = document.getElementById('profile-posts');
            const likesCount = document.getElementById('profile-likes');
            const daysCount = document.getElementById('profile-days');

            avatar.textContent = currentUser.username.charAt(0).toUpperCase();
            username.textContent = currentUser.username;
            badge.textContent = getUserBadge(currentUser.username);

            const stats = getUserStats(currentUser.username);
            postsCount.textContent = stats.posts;
            likesCount.textContent = stats.likes;
            daysCount.textContent = stats.days;
        }

        // „É©„É≥„Ç≠„É≥„Ç∞Ë°®Á§∫
        function showRanking() {
            const postRanking = document.getElementById('post-ranking');
            const likeRanking = document.getElementById('like-ranking');

            // „É¶„Éº„Ç∂„ÉºÁµ±Ë®à„ÇíÂèñÂæó
            const userStats = Object.keys(users).map(username => ({
                username,
                ...getUserStats(username)
            }));

            // ÊäïÁ®øÊï∞„É©„É≥„Ç≠„É≥„Ç∞
            const postRankingData = [...userStats].sort((a, b) => b.posts - a.posts);
            postRanking.innerHTML = postRankingData.map((user, index) => {
                const rankClass = index === 0 ? 'gold' : index === 1 ? 'silver' : index === 2 ? 'bronze' : '';
                return `
                    <li class="ranking-item">
                        <div class="rank-number ${rankClass}">${index + 1}</div>
                        <div class="user-avatar">${user.username.charAt(0).toUpperCase()}</div>
                        <div style="flex: 1; margin-left: 1rem;">
                            <div class="username">${user.username}</div>
                            <div style="color: #666; font-size: 0.9rem;">${user.posts}ÊäïÁ®ø</div>
                        </div>
                    </li>
                `;
            }).join('');

            // „ÅÑ„ÅÑ„Å≠Êï∞„É©„É≥„Ç≠„É≥„Ç∞
            const likeRankingData = [...userStats].sort((a, b) => b.likes - a.likes);
            likeRanking.innerHTML = likeRankingData.map((user, index) => {
                const rankClass = index === 0 ? 'gold' : index === 1 ? 'silver' : index === 2 ? 'bronze' : '';
                return `
                    <li class="ranking-item">
                        <div class="rank-number ${rankClass}">${index + 1}</div>
                        <div class="user-avatar">${user.username.charAt(0).toUpperCase()}</div>
                        <div style="flex: 1; margin-left: 1rem;">
                            <div class="username">${user.username}</div>
                            <div style="color: #666; font-size: 0.9rem;">${user.likes}„ÅÑ„ÅÑ„Å≠</div>
                        </div>
                    </li>
                `;
            }).join('');
        }

        // „É¶„Éº„Ç∂„Éº‰∏ÄË¶ßË°®Á§∫
        function showUsers() {
            const userGrid = document.getElementById('user-grid');

            userGrid.innerHTML = Object.keys(users).map(username => {
                const stats = getUserStats(username);
                const badge = getUserBadge(username);
                return `
                    <div class="user-card">
                        <div class="user-avatar" style="margin: 0 auto 1rem; width: 60px; height: 60px; font-size: 1.5rem;">
                            ${username.charAt(0).toUpperCase()}
                        </div>
                        <h3>${username}</h3>
                        ${badge ? `<div class="user-badge">${badge}</div>` : ''}
                        <div style="margin-top: 1rem; color: #666; font-size: 0.9rem;">
                            <div>${stats.posts}ÊäïÁ®ø ‚Ä¢ ${stats.likes}„ÅÑ„ÅÑ„Å≠</div>
                            <div>Âà©Áî®${stats.days}Êó•ÁõÆ</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // „É¶„Éº„Ç∂„ÉºÁµ±Ë®à„ÇíÂèñÂæó
        function getUserStats(username) {
            const userPosts = posts.filter(post => post.username === username);
            const totalLikes = userPosts.reduce((sum, post) => sum + post.likes.length, 0);

            const user = users[username];
            const createdDate = new Date(user.createdAt);
            const today = new Date();
            const daysDiff = Math.floor((today - createdDate) / (1000 * 60 * 60 * 24)) + 1;

            return {
                posts: userPosts.length,
                likes: totalLikes,
                days: daysDiff
            };
        }

        // „É¶„Éº„Ç∂„Éº„Éê„ÉÉ„Ç∏„ÇíÂèñÂæó
        function getUserBadge(username) {
            const stats = getUserStats(username);

            if (stats.posts >= 10) return 'üèÜ ÊäïÁ®øÁéã';
            if (stats.likes >= 10) return '‚≠ê ‰∫∫Ê∞óËÄÖ';
            if (stats.posts >= 5) return 'üìù „Ç¢„ÇØ„ÉÜ„Ç£„Éñ';
            if (stats.days >= 7) return 'üéØ Á∂ôÁ∂öËÄÖ';
            return null;
        }

        // ÁèæÂú®„ÅÆ„É¶„Éº„Ç∂„ÉºÁµ±Ë®à„ÇíÊõ¥Êñ∞
        function updateUserStats() {
            const statsDiv = document.getElementById('current-user-stats');
            const badgeSpan = document.getElementById('current-user-badge');

            const stats = getUserStats(currentUser.username);
            const badge = getUserBadge(currentUser.username);

            statsDiv.textContent = `${stats.posts}ÊäïÁ®ø ‚Ä¢ ${stats.likes}„ÅÑ„ÅÑ„Å≠`;
            badgeSpan.textContent = badge || '';
            badgeSpan.style.display = badge ? 'inline' : 'none';
        }

        // ÊäïÁ®ø„Ç∑„Çß„Ç¢Ê©üËÉΩ
        function sharePost(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;

            const shareText = `${post.username}„Åï„Çì„ÅÆÊäïÁ®ø: "${post.content}" - SimpleSNS„Çà„Çä`;

            if (navigator.share) {
                navigator.share({
                    title: 'SimpleSNSÊäïÁ®ø„Ç∑„Çß„Ç¢',
                    text: shareText
                });
            } else {
                // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: „ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('ÊäïÁ®øÂÜÖÂÆπ„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ');
                }).catch(() => {
                    alert('„Ç∑„Çß„Ç¢Ê©üËÉΩ„ÅØ„Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                });
            }
        }

        // „Éê„Éº„Ç∏„Éß„É≥ÁÆ°ÁêÜ
        function incrementVersion() {
            const currentVer = parseFloat(appVersion);
            appVersion = (currentVer + 0.01).toFixed(2);
            document.getElementById('app-version').textContent = `v${appVersion}`;
            localStorage.setItem('sns-app-version', appVersion);
        }

        function loadVersion() {
            const savedVersion = localStorage.getItem('sns-app-version');
            if (savedVersion) {
                appVersion = savedVersion;
            }
            document.getElementById('app-version').textContent = `v${appVersion}`;
        }

        // DOMContentLoadedÂæå„Å´Á¢∫ÂÆü„Å´ÂàùÊúüÂåñÂÆüË°å
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                init();
                loadVersion();
            });
        } else {
            init();
            loadVersion();
        }
    </script>
</body>
</html>